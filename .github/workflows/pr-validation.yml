name: PR Validation

# This workflow validates action files in pull requests
# 
# NOTE: This is a FRAMEWORK repository. This workflow is provided as a template
# for repositories that use this framework. It will only run if action files
# are present in the actions/ directory.
# 
# To use this in your repository:
# 1. Copy this workflow to your .github/workflows/ directory
# 2. Ensure your actions/ directory contains daily action files (*.md)
# 3. The workflow will automatically validate PRs that modify action files

on:
  pull_request:
    branches:
      - main
    paths:
      - 'actions/*.md'

jobs:
  validate:
    runs-on: ubuntu-latest
    name: Validate Action Files
    
    # Set minimal permissions for PR validation
    permissions:
      contents: read
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9'
      
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
      
      - name: Validate action files
        id: validation
        run: |
          PYTHONPATH=. python tools/pr_validator.py --file "actions/*.md"
      
      - name: Validation summary
        if: always()
        run: |
          if [ "${{ steps.validation.outcome }}" == "success" ]; then
            echo "✅ All action files are valid"
          else
            echo "❌ Validation failed - see errors above"
            exit 1
          fi
