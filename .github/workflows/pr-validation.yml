name: PR Validation

# This workflow validates action files in pull requests
# It runs on every PR to main and validates the format and schema
# of all action files without executing them

on:
  pull_request:
    branches:
      - main
    paths:
      - 'actions/*.md'

jobs:
  validate:
    runs-on: ubuntu-latest
    name: Validate Action Files
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9'
      
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
      
      - name: Validate action files
        id: validation
        run: |
          PYTHONPATH=. python tools/pr_validator.py --file "actions/*.md"
      
      - name: Validation summary
        if: always()
        run: |
          if [ "${{ steps.validation.outcome }}" == "success" ]; then
            echo "✅ All action files are valid"
          else
            echo "❌ Validation failed - see errors above"
            exit 1
          fi
